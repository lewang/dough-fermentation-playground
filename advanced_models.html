<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dough Playground - Advanced Models</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .nav-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }
        
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .nav-title {
            font-size: 1.8em;
            font-weight: bold;
            color: #4a5568;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .nav-title:hover {
            color: #667eea;
            transition: color 0.3s ease;
        }
        
        .hamburger {
            display: flex;
            flex-direction: column;
            cursor: pointer;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .hamburger:hover {
            background: rgba(102, 126, 234, 0.1);
        }
        
        .hamburger span {
            width: 25px;
            height: 3px;
            background: #4a5568;
            margin: 3px 0;
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        
        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }
        
        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }
        
        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-width: 250px;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }
        
        .dropdown-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            display: block;
            padding: 15px 20px;
            color: #4a5568;
            text-decoration: none;
            border-bottom: 1px solid #e2e8f0;
            transition: background 0.2s ease;
            font-weight: 500;
        }
        
        .dropdown-item:last-child {
            border-bottom: none;
        }
        
        .dropdown-item:hover {
            background: #f7fafc;
            color: #667eea;
        }
        
        .dropdown-item.active {
            background: #667eea;
            color: white;
        }
        
        .main-content {
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-width: 1200px;
        }
        .model-result { 
            margin: 15px 0; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 8px; 
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .excellent { border-color: #4caf50; background: #f1f8e9; }
        .good { border-color: #8bc34a; background: #f9fbe7; }
        .fair { border-color: #ff9800; background: #fff3e0; }
        .poor { border-color: #f44336; background: #ffebee; }
        .model-info { flex: 1; }
        .model-metrics { 
            text-align: right;
            font-weight: bold;
        }
        .test-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-weight: 600;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        .winner {
            border: 3px solid #4caf50;
            background: #e8f5e8;
            position: relative;
        }
        .winner::before {
            content: "üèÜ BEST MODEL";
            position: absolute;
            top: -10px;
            right: 10px;
            background: #4caf50;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .equation {
            font-family: 'Courier New', monospace;
            background: #f8f8f8;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 14px;
        }
        .parameters {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <nav class="nav-header">
        <div class="nav-container">
            <a href="index.html" class="nav-title">
                üçû‚ú® Dough Playground ‚ú®ü•ñ
            </a>
            <div class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
                <div class="dropdown-menu" id="dropdownMenu">
                    <a href="index.html" class="dropdown-item">üß™ Fermentation Predictor</a>
                    <a href="model_optimization.html" class="dropdown-item">üìä Model Optimization</a>
                    <a href="advanced_models.html" class="dropdown-item active">ü§ñ Advanced Models</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div class="container">
        <h1>üß¨ Advanced Fermentation Models Comparison</h1>
        <p>Testing various yeast growth and fermentation models against your CSV data</p>
        
        <button class="test-btn" onclick="testAllModels()">üß™ Test All Models</button>
        <button class="test-btn" onclick="findBestParameters()">üéØ Optimize Best Model</button>
        <button class="test-btn" onclick="showDetailedAnalysis()">üìä Detailed Analysis</button>
        
        <div id="results"></div>
        <div id="detailedResults" style="margin-top: 30px;"></div>
        </div>
    </div>

    <script>
        function toggleMenu() {
            const hamburger = document.querySelector('.hamburger');
            const menu = document.getElementById('dropdownMenu');
            
            hamburger.classList.toggle('active');
            menu.classList.toggle('show');
        }
        
        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            const hamburger = document.querySelector('.hamburger');
            const menu = document.getElementById('dropdownMenu');
            
            if (!hamburger.contains(event.target)) {
                hamburger.classList.remove('active');
                menu.classList.remove('show');
            }
        });
        
        // CSV data (same as before)
        const yeastConcentrations = [0.004, 0.008, 0.013, 0.021, 0.032, 0.042, 0.053, 0.063, 0.074, 0.084, 0.126, 0.168, 0.210, 0.252, 0.294, 0.336, 0.420];
        const temperatures = [1.7, 2.2, 2.8, 3.3, 3.9, 4.4, 5.0, 5.6, 6.1, 6.7, 7.2, 7.8, 8.3, 8.9, 9.4, 10.0, 10.6, 11.1, 11.7, 12.2, 12.8, 13.3, 13.9, 14.4, 15.0, 15.6, 16.1, 16.7, 17.2, 17.8, 18.3, 18.9, 19.4, 20.0, 20.6, 21.1, 21.7, 22.2, 22.8, 23.3, 23.9, 24.4, 25.0, 25.6, 26.1, 26.7, 27.2, 27.8, 28.3, 28.9, 29.4, 30.0, 30.6, 31.1, 31.7, 32.2, 32.8, 33.3, 33.9, 34.4, 35.0];
        
        const fermentationData = [
            [null,null,null,null,null,null,null,null,null,null,167,136,115,101,90,82,70],
            [null,null,null,null,null,null,null,null,null,null,149,121,103,90,80,73,62],
            [null,null,null,null,null,null,null,null,null,null,133,108,92,80,72,65,55],
            [null,null,null,null,null,null,null,null,null,161,120,97,82,72,65,59,50],
            [null,null,null,null,null,null,null,null,159,145,108,87,74,65,58,53,40],
            [null,null,null,null,null,null,null,161,144,130,97,79,67,59,52,48,37],
            [null,null,null,null,null,null,166,145,130,118,88,71,61,53,47,43,33],
            [null,null,null,null,null,null,151,132,118,107,80,65,55,48,43,39,30],
            [null,null,null,null,null,161,137,120,107,97,72,59,50,44,39,35,27],
            [null,null,null,null,null,147,125,109,98,88,66,53,45,40,36,32,25],
            [null,null,null,null,165,134,114,100,89,81,60,49,41,36,32,29,23],
            [null,null,null,null,151,122,104,91,81,74,55,45,38,33,30,27,19],
            [null,null,null,null,138,112,95,83,74,67,50,41,35,30,27,25,18],
            [null,null,null,null,126,102,87,76,68,62,46,37,32,28,25,23,16],
            [null,null,null,156,116,94,80,70,63,57,42,34,29,26,23,21,15],
            [null,null,null,143,107,86,74,64,58,52,39,32,27,23,21,19,14],
            [null,null,null,132,98,80,68,59,53,48,36,29,25,22,19,18,13],
            [null,null,null,122,90,73,62,55,49,44,33,27,23,20,18,16,11],
            [null,null,163,112,84,68,58,50,45,41,30,25,21,18,16,15,10],
            [null,null,150,104,77,63,53,47,42,38,28,23,19,17,15,14,9],
            [null,null,139,96,71,58,49,43,39,35,26,21,18,16,14,13,9],
            [null,null,129,89,66,54,46,40,36,32,24,20,17,15,13,12,8],
            [null,161,120,82,61,50,42,37,33,30,22,18,15,14,12,11,7],
            [null,149,111,77,57,46,39,34,31,28,21,17,14,13,11,10,7],
            [null,139,103,71,53,43,37,32,29,26,19,16,13,12,10,9,6],
            [null,129,96,66,49,40,34,30,27,24,18,15,12,11,10,9,6],
            [null,120,90,62,46,37,32,28,25,22,17,14,12,10,9,8,5],
            [null,112,83,58,43,35,30,26,23,21,16,13,11,9,8,8,5],
            [null,105,78,54,40,32,28,24,22,20,15,12,10,9,8,7,5],
            [162,98,73,50,37,30,26,23,20,18,14,11,9,8,7,7,4],
            [152,92,68,47,35,28,24,21,19,17,13,10,9,8,7,6,4],
            [142,86,64,44,33,27,23,20,18,16,12,10,8,7,6,6,3],
            [133,80,60,41,31,25,21,19,17,15,11,9,8,7,6,5,3],
            [120,73,54,37,28,22,19,17,15,14,10,8,7,6,5,5,3],
            [109,66,49,34,25,20,17,15,14,12,9,7,6,6,5,4,3],
            [99,60,45,31,23,19,16,14,12,11,8,7,6,5,4,4,2],
            [90,55,41,28,21,17,14,13,11,10,8,6,5,5,4,4,2],
            [83,50,37,26,19,15,13,12,10,9,7,6,5,4,4,3,2],
            [76,46,34,24,18,14,12,11,9,9,6,5,4,4,3,3,2],
            [70,42,32,22,16,13,11,10,9,8,6,5,4,4,3,3,2],
            [65,39,29,20,15,12,10,9,8,7,5,4,4,3,3,3,2],
            [60,36,27,19,14,11,10,8,7,7,5,4,3,3,3,2,2],
            [56,34,25,17,13,10,9,8,7,6,5,4,3,3,3,2,2],
            [52,31,23,16,12,10,8,7,6,6,4,4,3,3,2,2,2],
            [48,29,22,15,11,9,8,7,6,5,4,3,3,2,2,2,2],
            [45,27,20,14,10,8,7,6,6,5,4,3,3,2,2,2,2],
            [42,26,19,13,10,8,7,6,5,5,4,3,2,2,2,2,2],
            [40,24,18,12,9,7,6,6,5,5,3,3,2,2,2,2,2],
            [38,23,17,12,9,7,6,5,5,4,3,3,2,2,2,2,2],
            [36,21,16,11,8,7,6,5,4,4,3,2,2,2,2,2,2],
            [34,20,15,10,8,6,5,5,4,4,3,2,2,2,2,2,2],
            [32,19,14,10,7,6,5,4,4,4,3,2,2,2,2,2,2],
            [30,18,14,9,7,6,5,4,4,3,3,2,2,2,2,2,2],
            [29,18,13,9,7,5,5,4,4,3,2,2,2,2,2,2,2],
            [28,17,13,9,6,5,4,4,3,3,2,2,2,2,2,2,2],
            [27,16,12,8,6,5,4,4,3,3,2,2,2,2,2,2,2],
            [26,16,12,8,6,5,4,4,3,3,2,2,2,2,2,2,2],
            [25,15,11,8,6,5,4,3,3,3,2,2,2,2,2,2,2],
            [24,15,11,7,6,5,4,3,3,3,2,2,2,2,2,2,2],
            [23,14,10,7,5,4,4,3,3,3,2,2,2,2,2,2,2],
            [22,13,10,7,5,4,4,3,3,2,2,2,2,2,2,2,2]
        ];

        // Extract valid data points
        function getValidDataPoints() {
            const dataPoints = [];
            for (let tempIdx = 0; tempIdx < temperatures.length; tempIdx++) {
                for (let yeastIdx = 0; yeastIdx < yeastConcentrations.length; yeastIdx++) {
                    const time = fermentationData[tempIdx][yeastIdx];
                    if (time !== null) {
                        dataPoints.push({
                            temp: temperatures[tempIdx],
                            yeast: yeastConcentrations[yeastIdx],
                            time: time
                        });
                    }
                }
            }
            return dataPoints;
        }

        // Model definitions
        const models = [
            {
                name: "Optimized Arrhenius",
                equation: "Time = A √ó exp(Ea/(R√ó(T+273.15))) √ó (Yeast%)^(-n)",
                func: function(temp, yeast, A, Ea, n) {
                    const tempK = temp + 273.15;
                    return A * Math.exp(Ea / (8.314 * tempK)) * Math.pow(yeast, -n);
                },
                defaultParams: [1e-9, 55000, 0.5],
                paramNames: ["A", "Ea (J/mol)", "n"]
            },
            {
                name: "Power Law",
                equation: "Time = a √ó T^b √ó (Yeast%)^c",
                func: function(temp, yeast, a, b, c) {
                    return a * Math.pow(temp, b) * Math.pow(yeast, c);
                },
                defaultParams: [850, -1.8, -0.65],
                paramNames: ["a", "b", "c"]
            },
            {
                name: "Logistic Model",
                equation: "Time = a / (1 + b √ó exp(-c √ó Yeast √ó Temperature))",
                func: function(temp, yeast, a, b, c) {
                    return a / (1 + b * Math.exp(-c * yeast * temp));
                },
                defaultParams: [200, 100, 0.1],
                paramNames: ["a", "b", "c"]
            },
            {
                name: "Modified Gompertz",
                equation: "Time = A √ó exp(-exp((Œº/A) √ó (Œª - T) + 1)) / Yeast^n",
                func: function(temp, yeast, A, mu, lambda, n) {
                    return (A * Math.exp(-Math.exp((mu/A) * (lambda - temp) + 1))) / Math.pow(yeast, n);
                },
                defaultParams: [100, 2, 20, 0.5],
                paramNames: ["A", "Œº", "Œª", "n"]
            },
            {
                name: "Exponential-Power",
                equation: "Time = a √ó exp(b/T) √ó (Yeast%)^c",
                func: function(temp, yeast, a, b, c) {
                    return a * Math.exp(b/temp) * Math.pow(yeast, c);
                },
                defaultParams: [0.001, 1000, -0.5],
                paramNames: ["a", "b", "c"]
            },
            {
                name: "Polynomial Temperature",
                equation: "Time = (a + b√óT + c√óT¬≤) √ó (Yeast%)^d",
                func: function(temp, yeast, a, b, c, d) {
                    return (a + b*temp + c*temp*temp) * Math.pow(yeast, d);
                },
                defaultParams: [500, -20, 0.3, -0.6],
                paramNames: ["a", "b", "c", "d"]
            },
            {
                name: "Monod-like Model",
                equation: "Time = (a √ó Ks) / ((T - Tmin) √ó (Yeast + Ks))",
                func: function(temp, yeast, a, Ks, Tmin) {
                    return (a * Ks) / ((temp - Tmin) * (yeast + Ks));
                },
                defaultParams: [100, 0.05, 0],
                paramNames: ["a", "Ks", "Tmin"]
            },
            {
                name: "Square Root Model",
                equation: "Time = a √ó sqrt(T) √ó (Yeast%)^b + c",
                func: function(temp, yeast, a, b, c) {
                    return a * Math.sqrt(temp) * Math.pow(yeast, b) + c;
                },
                defaultParams: [1000, -0.8, 5],
                paramNames: ["a", "b", "c"]
            }
        ];

        function calculatePerformance(dataPoints, modelFunc, params) {
            let totalSquaredError = 0;
            let totalAbsError = 0;
            let validPredictions = 0;
            const errors = [];

            for (const point of dataPoints) {
                try {
                    const predicted = modelFunc(point.temp, point.yeast, ...params);
                    if (isFinite(predicted) && predicted > 0 && predicted < 1000) {
                        const error = predicted - point.time;
                        const absError = Math.abs(error);
                        const percentError = (absError / point.time) * 100;
                        
                        errors.push({
                            temp: point.temp,
                            yeast: point.yeast,
                            actual: point.time,
                            predicted: predicted,
                            error: error,
                            absError: absError,
                            percentError: percentError
                        });

                        totalSquaredError += error * error;
                        totalAbsError += absError;
                        validPredictions++;
                    }
                } catch (e) {
                    // Skip invalid predictions
                }
            }

            if (validPredictions === 0) return null;

            const rmse = Math.sqrt(totalSquaredError / validPredictions);
            const mae = totalAbsError / validPredictions;
            
            // Calculate R-squared
            const meanActual = dataPoints.reduce((sum, p) => sum + p.time, 0) / dataPoints.length;
            let totalSumSquares = 0;
            for (const error of errors) {
                totalSumSquares += Math.pow(error.actual - meanActual, 2);
            }
            const rSquared = 1 - (totalSquaredError / totalSumSquares);

            return { rmse, mae, rSquared, validPredictions, errors };
        }

        function getPerformanceClass(rmse) {
            if (rmse < 3) return 'excellent';
            if (rmse < 7) return 'good'; 
            if (rmse < 15) return 'fair';
            return 'poor';
        }

        function generateJavaScriptCode(model) {
            // Generate clean JavaScript code for each model type
            const params = model.defaultParams;
            const paramNames = model.paramNames;
            
            let constants = '';
            let functionBody = '';
            
            switch(model.name) {
                case "Optimized Arrhenius":
                    constants = `const A = ${params[0].toExponential(2)};
const Ea = ${params[1]};
const n = ${params[2]};`;
                    functionBody = `function predictTime(temp, yeast) {
    const tempK = temp + 273.15;
    return A * Math.exp(Ea / (8.314 * tempK)) * Math.pow(yeast, -n);
}`;
                    break;
                    
                case "Power Law":
                    constants = `const a = ${params[0]};
const b = ${params[1]};
const c = ${params[2]};`;
                    functionBody = `function predictTime(temp, yeast) {
    return a * Math.pow(temp, b) * Math.pow(yeast, c);
}`;
                    break;
                    
                case "Logistic Model":
                    constants = `const a = ${params[0]};
const b = ${params[1]};
const c = ${params[2]};`;
                    functionBody = `function predictTime(temp, yeast) {
    return a / (1 + b * Math.exp(-c * yeast * temp));
}`;
                    break;
                    
                case "Modified Gompertz":
                    constants = `const A = ${params[0]};
const mu = ${params[1]};
const lambda = ${params[2]};
const n = ${params[3]};`;
                    functionBody = `function predictTime(temp, yeast) {
    return (A * Math.exp(-Math.exp((mu/A) * (lambda - temp) + 1))) / Math.pow(yeast, n);
}`;
                    break;
                    
                case "Exponential-Power":
                    constants = `const a = ${params[0]};
const b = ${params[1]};
const c = ${params[2]};`;
                    functionBody = `function predictTime(temp, yeast) {
    return a * Math.exp(b/temp) * Math.pow(yeast, c);
}`;
                    break;
                    
                case "Polynomial Temperature":
                    constants = `const a = ${params[0]};
const b = ${params[1]};
const c = ${params[2]};
const d = ${params[3]};`;
                    functionBody = `function predictTime(temp, yeast) {
    return (a + b*temp + c*temp*temp) * Math.pow(yeast, d);
}`;
                    break;
                    
                case "Monod-like Model":
                    constants = `const a = ${params[0]};
const Ks = ${params[1]};
const Tmin = ${params[2]};`;
                    functionBody = `function predictTime(temp, yeast) {
    return (a * Ks) / ((temp - Tmin) * (yeast + Ks));
}`;
                    break;
                    
                case "Square Root Model":
                    constants = `const a = ${params[0]};
const b = ${params[1]};
const c = ${params[2]};`;
                    functionBody = `function predictTime(temp, yeast) {
    return a * Math.sqrt(temp) * Math.pow(yeast, b) + c;
}`;
                    break;
                    
                default:
                    return `// Error: Unknown model type\n// Parameters: ${paramNames.map((name, i) => `${name}=${params[i]}`).join(', ')}`;
            }
            
            return `// Model: ${model.name}
${constants}

${functionBody}`;
        }

        function testAllModels() {
            const dataPoints = getValidDataPoints();
            let results = [];

            for (const model of models) {
                const performance = calculatePerformance(dataPoints, model.func, model.defaultParams);
                if (performance) {
                    results.push({
                        model: model,
                        performance: performance
                    });
                }
            }

            // Sort by RMSE
            results.sort((a, b) => a.performance.rmse - b.performance.rmse);

            let html = '<h3>üèÜ Model Performance Ranking</h3>';
            
            results.forEach((result, index) => {
                const performanceClass = getPerformanceClass(result.performance.rmse);
                const isWinner = index === 0;
                
                html += `
                    <div class="model-result ${performanceClass} ${isWinner ? 'winner' : ''}">
                        <div class="model-info">
                            <h4>${result.model.name}</h4>
                            <div class="equation">${result.model.equation}</div>
                            <div class="parameters">
                                Parameters: ${result.model.paramNames.map((name, i) => 
                                    `${name}=${result.model.defaultParams[i]}`
                                ).join(', ')}
                            </div>
                        </div>
                        <div class="model-metrics">
                            <div>RMSE: ${result.performance.rmse.toFixed(2)}h</div>
                            <div>R¬≤: ${result.performance.rSquared.toFixed(4)}</div>
                            <div>MAE: ${result.performance.mae.toFixed(2)}h</div>
                            <div>Predictions: ${result.performance.validPredictions}/${dataPoints.length}</div>
                        </div>
                    </div>
                `;
            });

            const bestModel = results[0];
            html += `
                <div style="margin-top: 30px; padding: 20px; background: #e8f5e8; border-radius: 10px;">
                    <h3>üéØ Winner: ${bestModel.model.name}</h3>
                    <p><strong>Why it's better:</strong></p>
                    <ul>
                        <li>Lowest RMSE: ${bestModel.performance.rmse.toFixed(2)} hours</li>
                        <li>Highest R¬≤: ${bestModel.performance.rSquared.toFixed(4)} (closer to 1.0 is better)</li>
                        <li>Most accurate predictions across all temperature and yeast ranges</li>
                    </ul>
                    
                    <h4>Updated JavaScript for your webapp:</h4>
                    <textarea readonly style="width: 100%; height: 120px; font-family: monospace;">
${generateJavaScriptCode(bestModel.model)}
                    </textarea>
                </div>
            `;

            document.getElementById('results').innerHTML = html;
        }

        function findBestParameters() {
            document.getElementById('results').innerHTML = '<p>üîÑ Optimizing best model parameters... This may take a while.</p>';
            
            setTimeout(() => {
                // This would implement parameter optimization
                document.getElementById('results').innerHTML += '<p>‚úÖ Parameter optimization complete! (Feature under development)</p>';
            }, 2000);
        }

        function showDetailedAnalysis() {
            const dataPoints = getValidDataPoints();
            
            // Test your specific example
            const testCases = [
                { temp: 27.2, yeast: 0.210, actualTime: 2, description: "Your problem case" },
                { temp: 15.0, yeast: 0.126, actualTime: 19, description: "Mid-range test" },
                { temp: 35.0, yeast: 0.420, actualTime: 2, description: "High temp/yeast" }
            ];

            let html = '<h3>üîç Detailed Analysis for Specific Cases</h3>';
            
            for (const testCase of testCases) {
                html += `<h4>${testCase.description} (${testCase.temp}¬∞C, ${testCase.yeast}%, actual: ${testCase.actualTime}h)</h4>`;
                html += '<table border="1" style="width: 100%; margin: 10px 0;"><tr><th>Model</th><th>Predicted</th><th>Error</th><th>% Error</th></tr>';
                
                for (const model of models) {
                    try {
                        const predicted = model.func(testCase.temp, testCase.yeast, ...model.defaultParams);
                        const error = Math.abs(predicted - testCase.actualTime);
                        const percentError = (error / testCase.actualTime) * 100;
                        
                        const rowClass = percentError < 10 ? 'style="background: #e8f5e8;"' : 
                                        percentError < 30 ? 'style="background: #fff3e0;"' : 
                                        'style="background: #ffebee;"';
                        
                        html += `<tr ${rowClass}>
                            <td>${model.name}</td>
                            <td>${predicted.toFixed(1)}h</td>
                            <td>${error.toFixed(1)}h</td>
                            <td>${percentError.toFixed(1)}%</td>
                        </tr>`;
                    } catch (e) {
                        html += `<tr><td>${model.name}</td><td colspan="3">Error</td></tr>`;
                    }
                }
                html += '</table>';
            }

            document.getElementById('detailedResults').innerHTML = html;
        }

        // Auto-run test on load
        window.onload = function() {
            testAllModels();
        };
    </script>
</body>
</html>